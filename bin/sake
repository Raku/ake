#!/usr/bin/env perl6

use v6;
use Sake;

sub MAIN (*@tasks, :$file = 'Sakefile') {

    EVALFILE $file;
    if @tasks < 1 {
        note ‘No tasks given! Did you mean one of these?’;
        note .indent: 4 for %Sake::TASKS.keys.sort;
        exit 1
    }
    for @tasks -> $t { execute($t); }
}

sub look-for-sakefile(IO::Path $path) {
    return $path.absolute if $path.e;

    while my $parent = $path.parent {
        $parent = $parent.add('Sakefile');

        if $parent.e {
            return $parent.absolute;
        }
    }

    die "Could not find file $path!";
}
